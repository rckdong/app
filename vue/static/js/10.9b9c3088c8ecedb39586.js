webpackJsonp([10],{"o/Ay":function(e,t){},"prm+":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("KH7x"),a=o.n(r),i=o("aA9S"),l=o.n(i),n=o("4YfN"),s=o.n(n),c=o("4YDf"),m=o("ucOY"),p=(o("8+FI"),o("9rMa")),d=o("Du/2"),f=o("TVnW"),u=o("zilM"),g=o("DcgC"),b={components:{List:c.a,FormDialog:m.a,singleUpload:u.a,ExportExcel:g.a},computed:s()({},Object(p.c)(["global"])),filters:l()({},f.a),data:function(){var e=this;return{previewVisible:!1,imageUrl:"",pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,o=new Date;o.setTime(o.getTime()-6048e5),e.$emit("pick",[o,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,o=new Date;o.setTime(o.getTime()-2592e6),e.$emit("pick",[o,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,o=new Date;o.setTime(o.getTime()-7776e6),e.$emit("pick",[o,t])}}]},flagUploadSuccess:"",searchPros:{keyWord:{isRequire:!1,isNeedInput:!1},searchForm:[{contract_number:"",phone:"",brand_name:"",nickname:"",temp_time:"",book_time:"",status:""},{contract_number:"",phone:"",brand_name:"",nickname:"",temp_time:"",book_time:"",status:"",exportText:"上月导出",export_type:"exmonth"},{contract_number:"",phone:"",brand_name:"",nickname:"",temp_time:"",book_time:"",status:"",exportText:"本月导出",export_type:"month"},{contract_number:"",phone:"",brand_name:"",nickname:"",temp_time:"",book_time:"",status:"",exportText:"上周导出",export_type:"exweek"},{contract_number:"",phone:"",brand_name:"",nickname:"",temp_time:"",book_time:"",status:"",exportText:"本周导出",export_type:"week"},{contract_number:"",phone:"",brand_name:"",nickname:"",temp_time:"",book_time:"",status:"",exportText:"上季度导出",export_type:"exquarter"},{contract_number:"",phone:"",brand_name:"",nickname:"",temp_time:"",book_time:"",status:"",exportText:"本季度",export_type:"quarter"}],options:[{value:"",label:"全部"},{value:"0",label:"未完成合同"},{value:"1",label:"已完成合同"}]},detailSearchPros:{keyWord:{isRequire:!1,isNeedInput:!1},searchForm:[{id:"",type:"0"}]},detailListData:{incomes:0,expenses:0},currentId:"",formDialog:{operator:{title:"营业收支记录",rules:{type:[{required:!0,message:"请选择收入类型",trigger:"change"}],pay_type:[{required:!0,message:"请选择支付类型",trigger:"change"}],money:[{required:!0,message:"请输入金额",trigger:"blur"}],poundage:[{required:!0,message:"请输入手续费",trigger:"blur"}],certificate:[{required:!0,message:"请上传付款凭证",trigger:"blur"}]},form:[{type:"0",id:"",option:"",pay_type:"",money:"",poundage:"",ps:"",certificate:""}],onClose:function(t){e.formDialog.operator.visible=!1,e.flagUploadSuccess=(new Date).getTime()+"",e.$refs["actionNode_"+e.currentId].innerHTML='<i class="el-icon-setting"></i>&nbsp;操作选项',e.formDialog.operator.form=[{type:"0",id:"",option:"",pay_type:"",money:"",poundage:"",ps:"",certificate:""}],t&&e.RESPONSE_END({cancelLoadingBtn:!0})},submit:function(t){return e.$HTTP.financeAddIncomeLog(t)},visible:!1},view:{title:'<i class="el-icon-edit-outline"></i>查看收支记录',rules:{},refresh:"",form:[],onClose:function(t){e.formDialog.view.visible=!1,e.$refs["actionNode_"+e.currentId].innerHTML='<i class="el-icon-setting"></i>&nbsp;操作选项',e.currentId=""},submit:function(t){return e.$HTTP.financeAddIncomeLog(t)},visible:!1},add:{title:"收入记录",rules:{option:[{required:!0,message:"请选择收入类型",trigger:"change"}],money:[{required:!0,message:"请输入金额",trigger:"blur"}]},form:[{id:"",option:"",money:"",ps:""}],onClose:function(t){e.formDialog.add.visible=!1,e.$refs["actionNode_"+e.currentId].innerHTML='<i class="el-icon-setting"></i>&nbsp;操作选项',e.currentId="",e.formDialog.add.form=[{id:"",option:"",money:"",ps:""}],t&&e.RESPONSE_END({cancelLoadingBtn:!0})},submit:function(t){return e.$HTTP.financeAddExincomeLog(t)},visible:!1}},tableProps:[{tableData:[],currentPage:1,method:"get",getTabData:function(t){return e.$HTTP.financeBusinessList(t)},field:[],checkedField:[]}],detailTableProps:[{tableData:[],currentPage:1,method:"get",getTabData:function(t){return e.$HTTP.financeGetBusinessLog(t)},field:[]}],selects:{income_type:[],pay_type:[],out_type:[],ex_income_type:[]}}},methods:s()({},Object(p.b)([d.a,d.d]),{dataBranch:function(e){this.detailListData=e},preview:function(e){this.previewVisible=!0,this.imageUrl=e},dateCallback:function(){this.searchPros.searchForm[0].temp_time?this.searchPros.searchForm[0].book_time=this.searchPros.searchForm[0].temp_time[0]+" - "+this.searchPros.searchForm[0].temp_time[1]:this.searchPros.searchForm[0].book_time=""},uploadSuccess:function(e){var t=e.data,o=(e.flag,t.site_url,t.img_url);this.formDialog.operator.form[0].certificate=o},indexMethod:function(e){return e+1},handleCommand:function(e){var t=e.split("_"),o=a()(t,2),r=o[0],i=o[1];switch(this.currentId=i,this.$refs["actionNode_"+this.currentId].innerHTML='<i class="el-icon-loading"></i>请稍后...',r){case"preview":this.showIncomeLog();break;case"add":this.addIncomeLog();break;case"add2":this.addExincomeLog()}},addIncomeLog:function(){var e=this;this.formDialog.operator.form[0].id=this.currentId,this.$HTTP.financeSelectOptions({}).then(function(t){e.selects=t.data.data,e.formDialog.operator.visible=!0}).catch(function(t){e.$refs["actionNode_"+e.currentId].innerHTML='<i class="el-icon-setting"></i>&nbsp;操作选项',e.currentId=""})},addExincomeLog:function(){var e=this;this.formDialog.add.form[0].id=this.currentId,this.$HTTP.financeSelectOptions({}).then(function(t){e.selects=t.data.data,e.formDialog.add.visible=!0}).catch(function(t){e.$refs["actionNode_"+e.currentId].innerHTML='<i class="el-icon-setting"></i>&nbsp;操作选项',e.currentId=""})},showIncomeLog:function(){this.detailSearchPros.searchForm[0].id=this.currentId,this.formDialog.view.visible=!0,this.formDialog.view.refresh=(new Date).getTime()}})},_={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("List",{attrs:{searchPros:e.searchPros,tableProps:e.tableProps,refresh:e.global.refreshTime,response:e.global.responseEnd}},[o("el-breadcrumb",{attrs:{slot:"breadcrumb",separator:"/"},slot:"breadcrumb"},[o("el-breadcrumb-item",[e._v("财务管理")]),e._v(" "),o("el-breadcrumb-item",[e._v("营业收入")])],1),e._v(" "),o("template",{slot:"desc"},[o("ExportExcel",{staticStyle:{float:"right","margin-bottom":"10px","margin-left":"10px","margin-top":"10px"},attrs:{urlArgs:e.searchPros.searchForm[5],target:e.$HTTP.financeLogReport("",!0)}}),e._v(" "),o("ExportExcel",{staticStyle:{float:"right","margin-bottom":"10px","margin-left":"10px","margin-top":"10px"},attrs:{urlArgs:e.searchPros.searchForm[6],target:e.$HTTP.financeLogReport("",!0)}}),e._v(" "),o("ExportExcel",{staticStyle:{float:"right","margin-bottom":"10px","margin-left":"10px","margin-top":"10px"},attrs:{urlArgs:e.searchPros.searchForm[1],target:e.$HTTP.financeLogReport("",!0)}}),e._v(" "),o("ExportExcel",{staticStyle:{float:"right","margin-bottom":"10px","margin-left":"10px","margin-top":"10px"},attrs:{urlArgs:e.searchPros.searchForm[2],target:e.$HTTP.financeLogReport("",!0)}}),e._v(" "),o("ExportExcel",{staticStyle:{float:"right","margin-bottom":"10px","margin-left":"10px","margin-top":"10px"},attrs:{urlArgs:e.searchPros.searchForm[3],target:e.$HTTP.financeLogReport("",!0)}}),e._v(" "),o("ExportExcel",{staticStyle:{float:"right","margin-bottom":"10px","margin-left":"10px","margin-top":"10px"},attrs:{urlArgs:e.searchPros.searchForm[4],target:e.$HTTP.financeLogReport("",!0)}})],1),e._v(" "),o("template",{slot:"searchContainer"},[o("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"手机号码"},model:{value:e.searchPros.searchForm[0].phone,callback:function(t){e.$set(e.searchPros.searchForm[0],"phone",t)},expression:"searchPros.searchForm[0].phone"}}),e._v(" "),o("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"品牌名称"},model:{value:e.searchPros.searchForm[0].brand_name,callback:function(t){e.$set(e.searchPros.searchForm[0],"brand_name",t)},expression:"searchPros.searchForm[0].brand_name"}}),e._v(" "),o("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"客户名称"},model:{value:e.searchPros.searchForm[0].nickname,callback:function(t){e.$set(e.searchPros.searchForm[0],"nickname",t)},expression:"searchPros.searchForm[0].nickname"}}),e._v(" "),o("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"合同状态"},model:{value:e.searchPros.searchForm[0].status,callback:function(t){e.$set(e.searchPros.searchForm[0],"status",t)},expression:"searchPros.searchForm[0].status"}},e._l(e.searchPros.options,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),o("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"订车开始日期","end-placeholder":"订车结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions2},on:{change:e.dateCallback},model:{value:e.searchPros.searchForm[0].temp_time,callback:function(t){e.$set(e.searchPros.searchForm[0],"temp_time",t)},expression:"searchPros.searchForm[0].temp_time"}})],1),e._v(" "),o("template",{slot:"tableField"},[e.tableProps[0].deleteMulti?o("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._v(" "),o("el-table-column",{attrs:{align:"center",type:"index",index:e.indexMethod}}),e._v(" "),o("el-table-column",{attrs:{width:"150",prop:"saler_name",align:"center",label:"销售"}}),e._v(" "),o("el-table-column",{attrs:{prop:"contract_number",width:"150",align:"center",label:"合同编号"}}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"客户名称",width:"105"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.nickname))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"brand_name",align:"center",label:"品牌名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"car_model",width:"240",align:"center",label:"车型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"car_color",align:"center",label:"颜色"}}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"指导价格",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",{domProps:{innerHTML:e._s(e.$options.filters.filterCNYFormatting(t.row.guidance_price))}})]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"成交价",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",{domProps:{innerHTML:e._s(e.$options.filters.filterCNYFormatting(t.row.transaction_price))}})]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"销售日期",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",{domProps:{innerHTML:e._s(e.$options.filters.filterDate(t.row.book_time))}})]}}])})],1),e._v(" "),o("template",{slot:"action"},[o("el-table-column",{attrs:{align:"center",label:"操作",width:200},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-dropdown",{on:{command:e.handleCommand}},[o("el-button",{staticClass:"pointer",attrs:{type:"primary"}},[o("span",{ref:"actionNode_"+t.row.id},[o("i",{staticClass:"el-icon-setting"}),e._v(" 操作选项")]),e._v(" "),o("i",{staticClass:"el-icon-arrow-down el-icon&#45;&#45;right"})]),e._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{command:"add_"+t.row.id}},[e._v("\n                                添加营业收入记录\n                            ")]),e._v(" "),o("el-dropdown-item",{attrs:{command:"preview_"+t.row.id}},[e._v("查看收入记录")])],1)],1)]}}])})],1)],2),e._v(" "),o("FormDialog",{attrs:{visible:e.formDialog.operator.visible,form:e.formDialog.operator.form,rules:e.formDialog.operator.rules,submitData:e.formDialog.operator.submit,title:e.formDialog.operator.title,labelPosition:"left"},on:{onClose:e.formDialog.operator.onClose}},[o("template",{slot:"formElements"},[o("el-form-item",{attrs:{label:"收入类型",prop:"type"}},[o("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.formDialog.operator.form[0].option,callback:function(t){e.$set(e.formDialog.operator.form[0],"option",t)},expression:"formDialog.operator.form[0].option"}},e._l(e.selects.income_type,function(e,t){return o("el-option",{key:t,attrs:{label:e,value:e}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"支付类型",prop:"pay_type"}},[o("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.formDialog.operator.form[0].pay_type,callback:function(t){e.$set(e.formDialog.operator.form[0],"pay_type",t)},expression:"formDialog.operator.form[0].pay_type"}},e._l(e.selects.pay_type,function(e,t){return o("el-option",{key:t,attrs:{label:e,value:e}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"金额",prop:"money"}},[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$options.filters.filterCNYFormatting(e.formDialog.operator.form[0].money),placement:"top-start"}},[o("el-input",{staticStyle:{width:"150px","margin-left":"28px"},attrs:{clearable:!0,placeholder:"请输入金额"},model:{value:e.formDialog.operator.form[0].money,callback:function(t){e.$set(e.formDialog.operator.form[0],"money",t)},expression:"formDialog.operator.form[0].money"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"手续费",prop:"poundage"}},[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$options.filters.filterCNYFormatting(e.formDialog.operator.form[0].poundage),placement:"top-start"}},[o("el-input",{staticStyle:{width:"150px","margin-left":"15px"},attrs:{clearable:!0,placeholder:"请输入手续费"},model:{value:e.formDialog.operator.form[0].poundage,callback:function(t){e.$set(e.formDialog.operator.form[0],"poundage",t)},expression:"formDialog.operator.form[0].poundage"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"备注",prop:"ps"}},[o("el-input",{staticStyle:{width:"360px","margin-left":"28px"},attrs:{type:"textarea"},model:{value:e.formDialog.operator.form[0].ps,callback:function(t){e.$set(e.formDialog.operator.form[0],"ps",t)},expression:"formDialog.operator.form[0].ps"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"付款凭证",prop:"certificate"}},[o("div",[o("single-upload",{attrs:{uploadData:e.$CONSTANT.fileDirBusinessIncome,actionPanelLeft:"0",uploadFlag:"formDialog.form",random:e.flagUploadSuccess},on:{uploadSuccess:e.uploadSuccess}}),e._v(" "),o("el-input",{staticClass:"hide",model:{value:e.formDialog.operator.form[0].certificate,callback:function(t){e.$set(e.formDialog.operator.form[0],"certificate",t)},expression:"formDialog.operator.form[0].certificate"}})],1)])],1)],2),e._v(" "),o("FormDialog",{attrs:{visible:e.formDialog.view.visible,form:e.formDialog.view.form,rules:e.formDialog.view.rules,title:e.formDialog.view.title,titleSalting:!1,width:"95rem"}},[o("template",{slot:"formElements"},[o("ExportExcel",{staticStyle:{position:"absolute",right:"123px",top:"10px"},attrs:{urlArgs:e.detailSearchPros.searchForm[0],target:e.$HTTP.financeGetBusinessLog("",!0)}}),e._v(" "),o("span",{staticClass:"dialog-footer",staticStyle:{position:"absolute",right:"23px",top:"10px"}},[o("el-button",{attrs:{icon:"el-icon-circle-close",round:""},on:{click:e.formDialog.view.onClose}},[e._v("关闭")])],1),e._v(" "),o("List",{staticStyle:{width:"92rem","margin-left":"-0.5rem","margin-top":"-60px"},attrs:{isSearch:!1,isOperator:!1,searchPros:e.detailSearchPros,refresh:e.formDialog.view.refresh,tableProps:e.detailTableProps},on:{dataBranch:e.dataBranch}},[o("template",{slot:"tableField"},[o("el-table-column",{attrs:{align:"center",type:"index",index:e.indexMethod}}),e._v(" "),o("el-table-column",{attrs:{prop:"contract_number",align:"center",label:"合同编号"}}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"合同类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",{domProps:{innerHTML:e._s(e.$options.filters.filterContractType(t.row.contract_type))}})]}}])}),e._v(" "),o("el-table-column",{attrs:{width:"150",prop:"option",align:"center",label:"收支类型"}}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"收支方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(" "+e._s(t.row.pay_type)+" ")])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"金额",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",{domProps:{innerHTML:e._s(e.$options.filters.filterCNYFormatting(t.row.money))}})]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"手续费",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",{domProps:{innerHTML:e._s(e.$options.filters.filterCNYFormatting(t.row.poundage))}})]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(" "+e._s(t.row.ps)+" ")])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"收支凭证"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",{on:{click:function(o){e.preview(t.row.certificate)}}},[o("img",{staticStyle:{height:"25px",cursor:"pointer"},attrs:{src:t.row.certificate}})])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"创建时间",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",{domProps:{innerHTML:e._s(e.$options.filters.filterDate(t.row.create_at))}})]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"操作人"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(" "+e._s(t.row.clerk_name)+" ")])]}}])})],1),e._v(" "),o("template",{slot:"tableFooter"},[o("p",[o("strong",[e._v("统计：")]),e._v(" "),o("el-tag",[e._v("总收入金额： "),o("span",{domProps:{innerHTML:e._s(e.$options.filters.filterCNYFormatting(e.detailListData.incomes))}})]),e._v(" "),o("el-tag",{staticStyle:{"margin-left":"20px"},attrs:{type:"success"}},[e._v("总支出金额： "),o("span",{domProps:{innerHTML:e._s(e.$options.filters.filterCNYFormatting(e.detailListData.expenses))}})])],1)])],2)],1)],2),e._v(" "),o("FormDialog",{attrs:{visible:e.formDialog.add.visible,form:e.formDialog.add.form,rules:e.formDialog.add.rules,submitData:e.formDialog.add.submit,title:e.formDialog.add.title,labelPosition:"left"},on:{onClose:e.formDialog.add.onClose}},[o("template",{slot:"formElements"},[o("el-form-item",{attrs:{label:"收入类型",prop:"option"}},[o("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.formDialog.add.form[0].option,callback:function(t){e.$set(e.formDialog.add.form[0],"option",t)},expression:"formDialog.add.form[0].option"}},e._l(e.selects.ex_income_type,function(e,t){return o("el-option",{key:t,attrs:{label:e,value:e}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"金额",prop:"money"}},[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$options.filters.filterCNYFormatting(e.formDialog.add.form[0].money),placement:"top-start"}},[o("el-input",{staticStyle:{width:"150px","margin-left":"28px"},attrs:{clearable:!0,placeholder:"请输入金额"},model:{value:e.formDialog.add.form[0].money,callback:function(t){e.$set(e.formDialog.add.form[0],"money",t)},expression:"formDialog.add.form[0].money"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"备注",prop:"ps"}},[o("el-input",{staticStyle:{width:"360px","margin-left":"28px"},attrs:{type:"textarea"},model:{value:e.formDialog.add.form[0].ps,callback:function(t){e.$set(e.formDialog.add.form[0],"ps",t)},expression:"formDialog.add.form[0].ps"}})],1)],1)],2),e._v(" "),o("el-dialog",{attrs:{visible:e.previewVisible,"close-on-click-modal":!0,"close-on-press-escape":!0},on:{"update:visible":function(t){e.previewVisible=t}}},[o("img",{attrs:{width:"100%",src:e.imageUrl,alt:""}})])],1)},staticRenderFns:[]};var h=o("vSla")(b,_,!1,function(e){o("o/Ay")},"data-v-e4dca4f2",null);t.default=h.exports}});