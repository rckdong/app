webpackJsonp([24],{PxK9:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("KH7x"),a=r.n(o),l=r("aA9S"),i=r.n(l),n=r("4YfN"),s=r.n(n),c=r("4YDf"),p=r("ucOY"),m=(r("8+FI"),r("9rMa")),u=r("Du/2"),d=r("TVnW"),f=r("zilM"),g=r("DcgC"),b={components:{List:c.a,FormDialog:p.a,singleUpload:f.a,ExportExcel:g.a},computed:s()({},Object(m.c)(["global"])),filters:i()({},d.a),data:function(){var e=this;return{previewVisible:!1,imageUrl:"",pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-6048e5),e.$emit("pick",[r,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-2592e6),e.$emit("pick",[r,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-7776e6),e.$emit("pick",[r,t])}}]},flagUploadSuccess:"",searchPros:{keyWord:{isRequire:!1,isNeedInput:!1},searchForm:[{contract_number:"",phone:"",brand_name:"",nickname:"",temp_time:"",book_time:"",status:""}],options:[{value:"",label:"全部"},{value:"0",label:"未完成合同"},{value:"1",label:"已完成合同"}]},detailSearchPros:{keyWord:{isRequire:!1,isNeedInput:!1},searchForm:[{id:"",type:"1"}]},currentId:"",formDialog:{operator:{title:"营业支出记录",rules:{type:[{required:!0,message:"请选择收入类型",trigger:"change"}],pay_type:[{required:!0,message:"请选择支付类型",trigger:"change"}],money:[{required:!0,message:"请输入金额",trigger:"blur"}],poundage:[{required:!0,message:"请输入手续费",trigger:"blur"}],certificate:[{required:!0,message:"请上传付款凭证",trigger:"blur"}]},form:[{type:"1",id:"",option:"",pay_type:"",money:"",poundage:"",ps:"",certificate:""}],onClose:function(t){e.formDialog.operator.visible=!1,e.flagUploadSuccess=(new Date).getTime()+"",e.$refs["actionNode_"+e.currentId].innerHTML='<i class="el-icon-setting"></i>&nbsp;操作选项',e.formDialog.operator.form=[{type:"1",id:"",option:"",pay_type:"",money:"",poundage:"",ps:"",certificate:""}],t&&e.RESPONSE_END({cancelLoadingBtn:!0})},submit:function(t){return e.$HTTP.financeAddIncomeLog(t)},visible:!1},view:{title:'<i class="el-icon-edit-outline"></i>查看收支记录',rules:{},refresh:"",form:[],onClose:function(t){e.formDialog.view.visible=!1,e.$refs["actionNode_"+e.currentId].innerHTML='<i class="el-icon-setting"></i>&nbsp;操作选项',e.currentId=""},submit:function(t){return e.$HTTP.financeAddIncomeLog(t)},visible:!1}},tableProps:[{tableData:[],currentPage:1,method:"get",getTabData:function(t){return e.$HTTP.financeBusinessList(t)},field:[],checkedField:[]}],detailTableProps:[{tableData:[],currentPage:1,method:"get",getTabData:function(t){return e.$HTTP.financeGetBusinessLog(t)},field:[]}],selects:{income_type:[],pay_type:[],out_type:[],ex_income_type:[]}}},methods:s()({},Object(m.b)([u.a,u.d]),{preview:function(e){this.previewVisible=!0,this.imageUrl=e},dateCallback:function(){this.searchPros.searchForm[0].temp_time?this.searchPros.searchForm[0].book_time=this.searchPros.searchForm[0].temp_time[0]+" - "+this.searchPros.searchForm[0].temp_time[1]:this.searchPros.searchForm[0].book_time=""},uploadSuccess:function(e){var t=e.data,r=(e.flag,t.site_url,t.img_url);this.formDialog.operator.form[0].certificate=r},indexMethod:function(e){return e+1},handleCommand:function(e){var t=e.split("_"),r=a()(t,2),o=r[0],l=r[1];switch(this.currentId=l,this.$refs["actionNode_"+this.currentId].innerHTML='<i class="el-icon-loading"></i>请稍后...',o){case"preview":this.showIncomeLog();break;case"add":this.addIncomeLog()}},addIncomeLog:function(){var e=this;this.formDialog.operator.form[0].id=this.currentId,this.$HTTP.financeSelectOptions({}).then(function(t){e.selects=t.data.data,e.formDialog.operator.visible=!0}).catch(function(t){e.$refs["actionNode_"+e.currentId].innerHTML='<i class="el-icon-setting"></i>&nbsp;操作选项',e.currentId=""})},showIncomeLog:function(){this.detailSearchPros.searchForm[0].id=this.currentId,this.formDialog.view.visible=!0,this.formDialog.view.refresh=(new Date).getTime()}})},h={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("List",{attrs:{searchPros:e.searchPros,tableProps:e.tableProps,refresh:e.global.refreshTime,response:e.global.responseEnd}},[r("el-breadcrumb",{attrs:{slot:"breadcrumb",separator:"/"},slot:"breadcrumb"},[r("el-breadcrumb-item",[e._v("财务管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("营业支出")])],1),e._v(" "),r("template",{slot:"searchContainer"},[r("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"手机号码"},model:{value:e.searchPros.searchForm[0].phone,callback:function(t){e.$set(e.searchPros.searchForm[0],"phone",t)},expression:"searchPros.searchForm[0].phone"}}),e._v(" "),r("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"品牌名称"},model:{value:e.searchPros.searchForm[0].brand_name,callback:function(t){e.$set(e.searchPros.searchForm[0],"brand_name",t)},expression:"searchPros.searchForm[0].brand_name"}}),e._v(" "),r("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"客户名称"},model:{value:e.searchPros.searchForm[0].nickname,callback:function(t){e.$set(e.searchPros.searchForm[0],"nickname",t)},expression:"searchPros.searchForm[0].nickname"}}),e._v(" "),r("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"合同状态"},model:{value:e.searchPros.searchForm[0].status,callback:function(t){e.$set(e.searchPros.searchForm[0],"status",t)},expression:"searchPros.searchForm[0].status"}},e._l(e.searchPros.options,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),r("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"订车开始日期","end-placeholder":"订车结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions2},on:{change:e.dateCallback},model:{value:e.searchPros.searchForm[0].temp_time,callback:function(t){e.$set(e.searchPros.searchForm[0],"temp_time",t)},expression:"searchPros.searchForm[0].temp_time"}})],1),e._v(" "),r("template",{slot:"tableField"},[r("el-table-column",{attrs:{align:"center",type:"index",index:e.indexMethod}}),e._v(" "),r("el-table-column",{attrs:{width:"100",prop:"saler_name",align:"center",label:"销售"}}),e._v(" "),-1!=e.tableProps[0].checkedField.indexOf("合同编号")?r("el-table-column",{attrs:{prop:"contract_number",align:"center",width:"180",label:"合同编号"}}):e._e(),e._v(" "),-1!=e.tableProps[0].checkedField.indexOf("销售日期")?r("el-table-column",{attrs:{align:"center",label:"销售日期",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{domProps:{innerHTML:e._s(e.$options.filters.filterDate(t.row.book_time))}})]}}])}):e._e(),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"客户名称",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.nickname))])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"brand_name",align:"center",label:"品牌名称"}}),e._v(" "),-1!=e.tableProps[0].checkedField.indexOf("车型")?r("el-table-column",{attrs:{prop:"car_model",width:"270",align:"center",label:"车型"}}):e._e(),e._v(" "),r("el-table-column",{attrs:{prop:"car_color",align:"center",label:"颜色"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"成交价",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{domProps:{innerHTML:e._s(e.$options.filters.filterCNYFormatting(t.row.transaction_price))}})]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"已收入金额",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{domProps:{innerHTML:e._s(e.$options.filters.filterCNYFormatting(t.row.transaction_price))}})]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"贷款金额",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{domProps:{innerHTML:e._s(e.$options.filters.filterCNYFormatting(t.row.transaction_price))}})]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"收款率",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.pay_percent))])]}}])})],1),e._v(" "),r("template",{slot:"action"},[r("el-table-column",{attrs:{align:"center",label:"操作",width:200},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-dropdown",{on:{command:e.handleCommand}},[r("el-button",{staticClass:"pointer",attrs:{type:"primary"}},[r("span",{ref:"actionNode_"+t.row.id},[r("i",{staticClass:"el-icon-setting"}),e._v(" 操作选项")]),e._v(" "),r("i",{staticClass:"el-icon-arrow-down el-icon&#45;&#45;right"})]),e._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:"add_"+t.row.id}},[e._v("\n                                添加营业支出记录\n                            ")]),e._v(" "),r("el-dropdown-item",{attrs:{command:"preview_"+t.row.id}},[e._v("查看支出记录")])],1)],1)]}}])})],1)],2),e._v(" "),r("FormDialog",{attrs:{visible:e.formDialog.operator.visible,form:e.formDialog.operator.form,rules:e.formDialog.operator.rules,submitData:e.formDialog.operator.submit,title:e.formDialog.operator.title,labelPosition:"left"},on:{onClose:e.formDialog.operator.onClose}},[r("template",{slot:"formElements"},[r("el-form-item",{attrs:{label:"支出类型",prop:"type"}},[r("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.formDialog.operator.form[0].option,callback:function(t){e.$set(e.formDialog.operator.form[0],"option",t)},expression:"formDialog.operator.form[0].option"}},e._l(e.selects.out_type,function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"支付类型",prop:"pay_type"}},[r("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.formDialog.operator.form[0].pay_type,callback:function(t){e.$set(e.formDialog.operator.form[0],"pay_type",t)},expression:"formDialog.operator.form[0].pay_type"}},e._l(e.selects.pay_type,function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"金额",prop:"money"}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$options.filters.filterCNYFormatting(e.formDialog.operator.form[0].money),placement:"top-start"}},[r("el-input",{staticStyle:{width:"150px","margin-left":"28px"},attrs:{clearable:!0,placeholder:"请输入金额"},model:{value:e.formDialog.operator.form[0].money,callback:function(t){e.$set(e.formDialog.operator.form[0],"money",t)},expression:"formDialog.operator.form[0].money"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"手续费",prop:"poundage"}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$options.filters.filterCNYFormatting(e.formDialog.operator.form[0].poundage),placement:"top-start"}},[r("el-input",{staticStyle:{width:"150px","margin-left":"15px"},attrs:{clearable:!0,placeholder:"请输入手续费"},model:{value:e.formDialog.operator.form[0].poundage,callback:function(t){e.$set(e.formDialog.operator.form[0],"poundage",t)},expression:"formDialog.operator.form[0].poundage"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"备注",prop:"ps"}},[r("el-input",{staticStyle:{width:"360px","margin-left":"28px"},attrs:{type:"textarea"},model:{value:e.formDialog.operator.form[0].ps,callback:function(t){e.$set(e.formDialog.operator.form[0],"ps",t)},expression:"formDialog.operator.form[0].ps"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"付款凭证",prop:"certificate"}},[r("div",[r("single-upload",{attrs:{uploadData:e.$CONSTANT.fileDirBusinessIncome,actionPanelLeft:"78",uploadFlag:"formDialog.form",random:e.flagUploadSuccess},on:{uploadSuccess:e.uploadSuccess}}),e._v(" "),r("el-input",{model:{value:e.formDialog.operator.form[0].certificate,callback:function(t){e.$set(e.formDialog.operator.form[0],"certificate",t)},expression:"formDialog.operator.form[0].certificate"}})],1)])],1)],2),e._v(" "),r("FormDialog",{attrs:{visible:e.formDialog.view.visible,form:e.formDialog.view.form,rules:e.formDialog.view.rules,title:e.formDialog.view.title,titleSalting:!1,width:"95rem"}},[r("template",{slot:"formElements"},[r("ExportExcel",{staticStyle:{position:"absolute",right:"123px",top:"10px"},attrs:{urlArgs:e.detailSearchPros.searchForm[0],target:e.$HTTP.financeGetBusinessLog("",!0)}}),e._v(" "),r("span",{staticClass:"dialog-footer",staticStyle:{position:"absolute",right:"23px",top:"10px"}},[r("el-button",{attrs:{icon:"el-icon-circle-close",round:""},on:{click:e.formDialog.view.onClose}},[e._v("关闭")])],1),e._v(" "),r("List",{staticStyle:{width:"92rem","margin-left":"-0.5rem","margin-top":"-60px"},attrs:{isSearch:!1,isOperator:!1,searchPros:e.detailSearchPros,refresh:e.formDialog.view.refresh,tableProps:e.detailTableProps}},[r("template",{slot:"tableField"},[r("el-table-column",{attrs:{align:"center",type:"index",index:e.indexMethod}}),e._v(" "),r("el-table-column",{attrs:{prop:"contract_number",align:"center",label:"合同编号"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"合同类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{domProps:{innerHTML:e._s(e.$options.filters.filterContractType(t.row.contract_type))}})]}}])}),e._v(" "),r("el-table-column",{attrs:{width:"150",prop:"option",align:"center",label:"收支类型"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"收支方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",[e._v(" "+e._s(t.row.pay_type)+" ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"金额",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{domProps:{innerHTML:e._s(e.$options.filters.filterCNYFormatting(t.row.money))}})]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"手续费",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{domProps:{innerHTML:e._s(e.$options.filters.filterCNYFormatting(t.row.poundage))}})]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",[e._v(" "+e._s(t.row.ps)+" ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"收支凭证"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{on:{click:function(r){e.preview(t.row.certificate)}}},[r("img",{staticStyle:{height:"25px",cursor:"pointer"},attrs:{src:t.row.certificate}})])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"创建时间",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{domProps:{innerHTML:e._s(e.$options.filters.filterDate(t.row.create_at))}})]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"操作人"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",[e._v(" "+e._s(t.row.clerk_name)+" ")])]}}])})],1)],2)],1),e._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"})],2),e._v(" "),r("el-dialog",{attrs:{visible:e.previewVisible,"close-on-click-modal":!0,"close-on-press-escape":!0},on:{"update:visible":function(t){e.previewVisible=t}}},[r("img",{attrs:{width:"100%",src:e.imageUrl,alt:""}})])],1)},staticRenderFns:[]};var _=r("vSla")(b,h,!1,function(e){r("ZPwt")},"data-v-0dbb76da",null);t.default=_.exports},ZPwt:function(e,t){}});